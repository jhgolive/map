<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>실시간 내 위치</title>
  <style>
    html, body, #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
  <!-- 카카오맵 JS SDK -->
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=472f378af49957df6636a87b97fb6fd6"></script>
</head>
<body>
  <div id="map"></div>
  <script>
    // 서버에서 위치 가져올 API URL
    const API_URL = "https://your-server.com/location"; // JSON 응답: { lat: 37.5665, lng: 126.9780 }

    // 지도 초기화
    const container = document.getElementById("map");
    const options = {
      center: new kakao.maps.LatLng(37.5665, 126.9780), // 기본 위치 (서울시청)
      level: 4
    };
    const map = new kakao.maps.Map(container, options);

    // 마커 생성
    const marker = new kakao.maps.Marker({
      position: map.getCenter(),
      map: map
    });

    // 위치 갱신 함수
    async function updateLocation() {
      try {
        const res = await fetch(API_URL + "?t=" + Date.now()); // 캐시 방지
        const data = await res.json();
        if (data.lat && data.lng) {
          const newPos = new kakao.maps.LatLng(data.lat, data.lng);

          // 지도 중심 이동
          map.setCenter(newPos);

          // 마커 위치 이동
          marker.setPosition(newPos);
        }
      } catch (err) {
        console.error("위치 불러오기 실패:", err);
      }
    }

    // 3초마다 위치 업데이트
    setInterval(updateLocation, 3000);

    // 처음 실행
    updateLocation();
  </script>
</body>
</html>
