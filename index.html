<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>실시간 내 위치 - Google Maps</title>
  <style>
    html, body, #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }
  </style>
  <!-- Google Maps JS SDK -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD2IUhkvbuEcusM3ejd_nVKEcJddnuotKQ"></script>
</head>
<body>
  <div id="map"></div>
  <script>
    let map;
    let marker;

    function initMap(lat, lng) {
      const pos = { lat: lat, lng: lng };
      map = new google.maps.Map(document.getElementById("map"), {
        center: pos,
        zoom: 15
      });
      marker = new google.maps.Marker({
        position: pos,
        map: map,
        title: "내 위치"
      });
    }

    async function updateLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          const newPos = { lat: pos.coords.latitude, lng: pos.coords.longitude };

          if (!map) {
            initMap(newPos.lat, newPos.lng);
          } else {
            marker.setPosition(newPos);
            map.setCenter(newPos);
          }
        }, err => {
          console.error("GPS 사용 불가:", err);
        });
      } else {
        alert("GPS를 지원하지 않는 브라우저입니다.");
      }
    }

    // 3초마다 위치 갱신
    setInterval(updateLocation, 3000);
    updateLocation(); // 초기 실행
  </script>
</body>
</html>
