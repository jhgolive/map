<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>IP 기반 내 위치 표시</title>
  <link 
    rel="stylesheet" 
    href="https://unpkg.com/leaflet/dist/leaflet.css" 
  />
  <style>
    #map { height: 100vh; width: 100%; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // 지도 초기화 (기본 위치: 서울)
    const map = L.map('map').setView([37.5665, 126.9780], 12);

    // OSM 타일 추가
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
    }).addTo(map);

    // IP 기반 위치 가져오기
    fetch('https://ipapi.co/json/')
      .then(res => res.json())
      .then(data => {
        const lat = data.latitude;
        const lon = data.longitude;
        const city = data.city;
        const region = data.region;

        // 지도 중심 이동
        map.setView([lat, lon], 13);

        // 마커 추가
        L.marker([lat, lon]).addTo(map)
          .bindPopup(`대략적인 위치: ${city}, ${region}`)
          .openPopup();
      })
      .catch(err => {
        console.error("IP 기반 위치 불러오기 실패:", err);
      });
  </script>
</body>
</html>
